(function(t){function e(e){for(var s,o,a=e[0],l=e[1],c=e[2],u=0,d=[];u<a.length;u++)o=a[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);h&&h(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],s=!0,a=1;a<n.length;a++){var l=n[a];0!==i[l]&&(s=!1)}s&&(r.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},i={app:0},r=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/spaces/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var h=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var s=n("85ec"),i=n.n(s);i.a},"05cc":function(t,e,n){t.exports=n.p+"img/zoom.6da0dbea.svg"},"0880":function(t,e,n){t.exports=n.p+"img/cross.784939f4.svg"},"0c1b":function(t,e,n){},"12cc":function(t,e,n){},"15ce":function(t,e,n){t.exports=n.p+"img/steps.fbe8b67c.svg"},"18f6":function(t,e,n){},"1d56":function(t,e,n){},"21ab":function(t,e,n){"use strict";var s=n("1d56"),i=n.n(s);i.a},"32e3":function(t,e,n){"use strict";var s=n("12cc"),i=n.n(s);i.a},3736:function(t,e,n){},"3d99":function(t,e,n){},4617:function(t,e,n){"use strict";var s=n("c233"),i=n.n(s);i.a},5160:function(t,e,n){},"51ff":function(t,e,n){"use strict";var s=n("7bab"),i=n.n(s);i.a},"56d7":function(t,e,n){"use strict";n.r(e);var s=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Menu",{attrs:{id:"menu"}}),n("div",{attrs:{id:"mainContent"}},[n("SvgViewport",{ref:"svgViewport"},[n("g",{ref:"mainGroup",on:{mousemove:function(e){return t.mouseMove(e)},mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:t.mouseDown()},mouseup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:t.mouseUp(e)}}},[n("rect",{attrs:{x:"0",y:"0",width:t.drawingSize.x,height:t.drawingSize.y,fill:"white"}}),t.debugMode?n("DebugView"):t._e(),t._l(t.shapes,(function(e){return n("path",{key:e.id,attrs:{d:t.getPath(e.points),"stroke-width":"0",fill:"black"}})})),t.drawingState?[n("path",{attrs:{d:t.currentPath,stroke:"black",fill:"none","stroke-width":"1"}}),n("Guides"),t.showStartPoint?n("DrawingPoint",{attrs:{point:t.startPoint,type:2,hovered:t.hoveredElement===t.startPoint}}):t._e(),n("DrawingPoint",{attrs:{point:t.currentPoint,type:1}})]:t._e()],2)]),t.debugMode?n("DebugInfo",{attrs:{mouse:t.mousePosition,cursor:t.currentPoint,hovered:t.hoveredElement}}):t._e()],1),n("Tutorial",{staticClass:"fullScreen"}),n("ExportModal",{staticClass:"fullScreen"}),n("New",{staticClass:"fullScreen"})],1)},r=[],o=n("2f62");const a="drawing",l="tutorial",c="export",h="preview",u="new";var d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"debugPanel"}},[n("p",[t._v("mouse : "+t._s(t.display(t.mouse)))]),n("p",[t._v("cursor : "+t._s(t.display(t.cursor)))]),n("p",[t._v("hovered : "+t._s(t.hoveredInfos))])])},p=[];const m=.001;function g(t,e){return Math.abs(t-e)<m}function f(t,e,n){const s=[],i=e**2-4*t*n;if(i>=0){const n=Math.sqrt(i);s.push((-e-n)/(2*t)),i>0&&s.push((-e+n)/(2*t))}return s}function v(t,e,n,s){if(0===e)return n;const i=Math.cos(t),r=Math.sin(t);let o=e,a=i*o+n.x;s&&(a<0||a>s.x)&&(a=Math.min(s.x,Math.max(0,a)),o=(a-n.x)/i);let l=r*o+n.y;return s&&(l<0||l>s.y)&&(l=Math.min(s.y,Math.max(0,l)),o=(l-n.y)/r,a=i*o+n.x),{x:a,y:l}}class w{constructor(t,e){this.dx=e.x-t.x,this.dy=e.y-t.y,this.length=Math.hypot(this.dx,this.dy)}angleWith(t){const e=this.dx*t.dx+this.dy*t.dy,n=e/(this.length*t.length);return Math.acos(Math.max(-1,Math.min(1,n)))}signedAngleWith(t){const e=this.dx*t.dy-this.dy*t.dx;return Math.sign(e)*this.angleWith(t)}}class x{constructor(t,e){this.x=t||0,this.y=e||0}getSquaredDistanceTo(t){const e=t.x-this.x,n=t.y-this.y;return e**2+n**2}equiv(t){return g(this.x,t.x)&&g(this.y,t.y)}}function y(t,e,n,s){const{x:i,y:r}=v(t,e,n,s);return new x(i,r)}let S=0;class b extends x{constructor(t,e){super(t,e),this.crossingLines=[],this.id="P"+S++}static createFrom(t){return new b(t.x,t.y)}}function k(t){let e,n=0;for(e=0;e<t.length-1;e++)n+=(t[e+1].x-t[e].x)*(t[e+1].y+t[e].y);return n+=(t[0].x-t[e].x)*(t[0].y+t[e].y),n<=0}function P(t,e,n){let s=e.x-t.x;const i=e.y-t.y;0===s&&(s=.01);const r=-i/s;let o=n/Math.sqrt(r*r+1);return s>0&&(o*=-1),{A2:new x(o*r+t.x,o+t.y),B2:new x(o*r+e.x,o+e.y)}}function M(t,e,n,s,i){const r=e.x-t.x,o=e.y-t.y,a=s.x-n.x,l=s.y-n.y,c=t.x-n.x,h=t.y-n.y,u=l*c-a*h,d=a*o-l*r;if(g(d,0)){if(g(u,0)){if(i){const i=g(t.x,e.x)?e=>(e.y-t.y)/o:e=>(e.x-t.x)/r,a=[t,e,n,s].map(t=>({point:t,t:i(t)})).sort((t,e)=>t.t-e.t).map(t=>t.point);return a[1]===a[2]?a[1]:[a[1],a[2]]}return[t,e]}return}const p=u/d;if(i&&(p<0||p>1))return;if(g(p,0))return t;if(g(p,1))return e;const m=o*-c-r*-h,f=-d,v=m/f;return i&&(v<0||v>1)?void 0:g(v,0)?n:g(v,1)?s:new x(t.x+r*p,t.y+o*p)}function _(t,e,n){return t.x>=0&&t.x<=e&&t.y>=0&&t.y<=n}function A(t,e,n){if(0===t.dx){const s=t.intersections[0].x;return f(1,-2*e.y,e.y**2+(s-e.x)**2-n**2).map(t=>new x(s,t))}return f(1+t.a**2,2*(t.a*(t.b-e.y)-e.x),e.x**2+(t.b-e.y)**2-n**2).map(e=>new x(e,t.y(e)))}function C(t,e){Object.values(e).forEach(e=>{Object.defineProperty(t,e.name,{get(){return Object.defineProperty(t,e.name,{configurable:!0,enumerable:!0,value:e.apply(t),writable:!0}),t[e.name]},configurable:!0,enumerable:!0})})}class E{constructor(t,e){this.A=t,this.B=e,this.onCoordinatesChanged()}onCoordinatesChanged(){C(this,{dx:()=>this.B.x-this.A.x,dy:()=>this.B.y-this.A.y,a:()=>this.dy/this.dx,b:()=>this.A.y-this.a*this.A.x,squaredLength:()=>this.dx**2+this.dy**2})}y(t){return 0===this.dx?1/0:this.a*t+this.b}x(t){return 0===this.dx?this.A.x:0===this.dy?1/0:(t-this.b)/this.a}includes(t){return 0!==this.dx&&g(t.y,this.y(t.x))||0!==this.dy&&g(t.x,this.x(t.y))}getProjection(t){const e=this.getProjectionParametricCoordinate(t);return new x(this.A.x+e*this.dx,this.A.y+e*this.dy)}getProjectionParametricCoordinate(t){return((t.x-this.A.x)*this.dx+(t.y-this.A.y)*this.dy)/this.squaredLength}getLineBounds(t,e){if(0===this.dx)return[new x(this.A.x,0),new x(this.A.x,e)];if(0===this.dy)return[new x(0,this.A.y),new x(t,this.A.y)];const n=[new x(0,this.y(0)),new x(this.x(0),0),new x(t,this.y(t)),new x(this.x(e),e)],s=[];return n.forEach(n=>{(0===s.length||1===s.length&&n.x!==s[0].x&&n.y!==s[0].y)&&_(n,t,e)&&s.push(n)}),s}}let B=0;class $ extends E{constructor(t,e,n,s){super(t,e),this.intersections=[],this.addPoint(t),this.addPoint(e),this.parallels=[],this.linkedShapes=[],this.updateLineBounds(n,s),this.id="L"+B++}addPoint(t){t instanceof b&&(this.intersections.includes(t)||this.intersections.push(t),t.crossingLines.includes(this)||t.crossingLines.push(this))}static linkParallelLines(t,e){t.parallels.includes(e)||(t.parallels.push(e),e.parallels.push(t))}includes(t){return this.intersections.includes(t)||super.includes(t)}getKnownIntersectionWith(t){return this.intersections.find(e=>e.crossingLines.includes(t))}getOrCreateIntersectionWith(t){let e=this.getKnownIntersectionWith(t);if(void 0===e&&(e=M(this.intersections[0],this.intersections[1],t.intersections[0],t.intersections[1]),e instanceof x)){const n=b.createFrom(e);this.addPoint(n),t.addPoint(n)}return e}updateLineBounds(t,e){this.bounds=this.getLineBounds(t,e)}}var L={name:"DebugInfo",props:{mouse:{type:Object,default:new x},cursor:{type:Object,default:new x},hovered:{type:Object,default:void 0}},computed:{hoveredInfos(){return this.hovered instanceof b?this.hovered.id+" > "+this.hovered.crossingLines.reduce((t,e)=>{let n=t;return""!==n&&(n+=", "),n+=e.id,n},""):this.hovered instanceof $?this.hovered.id:"-"}},methods:{round(t){return Math.round(100*t)/100},display(t){return`(${this.round(t.x)},\t${this.round(t.y)})`}}},O=L,I=(n("b199"),n("2877")),z=Object(I["a"])(O,d,p,!1,null,"3b563d46",null),j=z.exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{attrs:{id:"DebugView"}},[t._l(t.stepSegments,(function(t){return n("line",{key:t.id,attrs:{x1:t.A.x,y1:t.A.y,x2:t.B.x,y2:t.B.y,"stroke-width":"4",stroke:"#00ff0022"}})})),t._l(t.snappingSegments,(function(t){return n("line",{key:t.id,attrs:{x1:t.A.x,y1:t.A.y,x2:t.B.x,y2:t.B.y,"stroke-width":"4",stroke:"#ff000033"}})})),t._l(t.snappingPoints,(function(t){return n("circle",{key:t.id,attrs:{cx:t.x,cy:t.y,r:"6",fill:"#ff000033"}})}))],2)},T=[];class W extends E{constructor(t,e,n){super(t,e),this.associatedLine=n}includes(t){const e=(t.y-this.A.y)*this.dx-(t.x-this.A.x)*this.dy;return g(Math.abs(e),0)&&t.x>=Math.min(this.A.x,this.B.x)&&t.x<=Math.max(this.A.x,this.B.x)&&t.y>=Math.min(this.A.y,this.B.y)&&t.y<=Math.max(this.A.y,this.B.y)}getProjection(t){const e=this.getProjectionParametricCoordinate(t);return e<=0?this.A:e>=1?this.B:new x(this.A.x+e*this.dx,this.A.y+e*this.dy)}constrainToBounds(t,e){const n=[];if(_(this.A,t,e)||n.push(this.A),_(this.B,t,e)||n.push(this.B),n.length>0){const s=this.getLineBounds(t,e);n.forEach(t=>{let e;e=2!==s.length?{x:0,y:0}:t.getSquaredDistanceTo(s[0])<t.getSquaredDistanceTo(s[1])?s[0]:s[1],t.x=e.x,t.y=e.y}),this.onCoordinatesChanged()}}}function H(t,e,n,s){if(0===n.length)return{points:t,segments:e};const i=n.slice(-2).reverse();let r;return s.minAngle>0&&i.length>1&&(r=Math.atan2(i[1].y-i[0].y,i[1].x-i[0].x)),0===s.angleStep?V(t,e,i,r,s):U(t,e,i,r,s)}function V(t,e,n,s,i){const r=i.minStroke**2,o=i.maxStroke**2;t=t.filter(t=>{const e=n[0].getSquaredDistanceTo(t);return e>r&&e<=o});let a=[];if(e.map(t=>R(t,n[0],i.minStroke,i.maxStroke)).flat().forEach(e=>{e instanceof x?t.push(e):e instanceof W&&a.push(e)}),void 0!==s){const e=new w(n[0],n[1]),r=t=>{const s=e.angleWith(new w(n[0],t));return s>=i.minAngle};t=t.filter(t=>r(t));const o=new W(n[0],y(s-i.minAngle,i.maxStroke,n[0])),l=new W(n[0],y(s+i.minAngle,i.maxStroke,n[0]));a=a.map(t=>{const e=M(t.A,t.B,o.A,o.B,!0),n=M(t.A,t.B,l.A,l.B,!0),s=[e,n].filter(t=>t);if(0===s.length)return r(t.A)?[t]:[];if(1===s.length){const e=s[0];return Array.isArray(e)&&2===e.length?new W(e[0],e[1]):r(t.A)?[new W(t.A,e,t.associatedLine)]:[new W(t.B,e,t.associatedLine)]}const i=[t.A,t.B,s[0],s[1]];return t.A.x-t.B.x===0?i.sort((t,e)=>t.y-e.y):i.sort((t,e)=>t.x-e.x),[new W(i[0],i[1],t.associatedLine),new W(i[2],i[3],t.associatedLine)]}).flat()}return a.forEach(t=>{t instanceof W&&t.constrainToBounds(i.drawingSize.x,i.drawingSize.y)}),{points:t.filter(t=>t),segments:a.filter(t=>t)}}function U(t,e,n,s,i){const r=F(n,s,i),o=t.filter(t=>t!==n[0]&&r.some(e=>e.includes(t))),a=[],l=t=>{o.includes(t)||t===n[0]||o.push(t)};return e.forEach(t=>r.forEach(e=>{const s=M(e.A,e.B,t.bounds[0],t.bounds[1],!0);if(s instanceof b)l(s);else if(s instanceof x&&!s.equiv(n[0])){const e=t.intersections.filter(t=>t.equiv(s));if(e.length>0&&e[0])l(e[0]);else{const e=b.createFrom(s);e.crossingLines.push(t),l(e)}}Array.isArray(s)&&2===s.length&&a.push(new W(s[0],s[1]))})),{points:o,segments:a}}function F(t,e,n){let s=t=>!0;if(t.length>1){const e=new w(t[0],t[1]);s=s=>{const i=e.angleWith(new w(t[0],s));return i>=n.minAngle}}const i=[],r=Math.round(Math.PI/n.angleStep);for(let o=0;o<r;o++){const r=o*n.angleStep,a=r-Math.PI,l=y(r,n.maxStroke,t[0],n.drawingSize),c=y(r,n.minStroke,t[0],n.drawingSize),h=y(a,n.minStroke,t[0],n.drawingSize),u=y(a,n.maxStroke,t[0],n.drawingSize);if(0===n.minStroke){let r=l,o=u;void 0!==e&&n.minAngle>0&&(s(r)||(r=t[0]),s(o)||(o=t[0])),r!==o&&i.push(new W(r,o))}else(0===n.minAngle||s(l))&&i.push(new W(l,c)),(0===n.minAngle||s(u))&&i.push(new W(h,u))}return i}function R(t,e,n,s){const i=A(t,e,s);if(i.length<=1)return i;let r=[];return n>0&&(r=A(t,e,n)),r.length<=1?[new W(i[0],i[1],t)]:[new W(i[0],r[0],t),new W(i[1],r[1],t)]}function N(t,e,n){if(e.length>0){const s=e.slice(-2).reverse();let i=q(s[0],t,n.minStroke,n.maxStroke);return i=Y(s[0],i,s[1],n.minAngle,n.angleStep),i}return t}function q(t,e,n,s){const i=e.x-t.x,r=e.y-t.y;if(0===i&&0===r&&n>0)return new x(e.x,e.y-n);const o=i**2+r**2,a=Math.max(n**2,Math.min(s**2,o));if(a===o)return e;const l=Math.sqrt(a/o)-1;return new x(e.x+l*i,e.y+l*r)}function Y(t,e,n,s,i){const r=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,r);let l=a,c=!1;if(void 0!==n&&s>0){const r=new w(t,n),o=Math.atan2(r.dy,r.dx),a=new w(t,e),h=r.signedAngleWith(a),u=Math.sign(h);let d=o+s*u,p=s*u;i>0&&(d=Math.ceil(d/i)*i,u<0&&(d-=i),p=(d-o)/u),Math.abs(h)<Math.abs(p)&&(l=d,c=!0)}if(i>0&&!c&&(l=Math.round(l/i)*i),l!==a){const e=Math.hypot(r,o);return new x(t.x+e*Math.cos(l),t.y+e*Math.sin(l))}return e}function K(t,e,n){const s=t.length,i=e.length;n=n||0;while(n<0)n+=s;for(let r=n;r!==s+n;++r){const n=[];for(let e=0;e!==i;e++)n.push(t[(r+e)%s]);e(...n)}}function X(t,e){const n=[],s=t.length,i=e.length;for(let r=0;r!==s;++r){const o=[];for(let e=0;e!==i;e++)o.push(t[(r+e)%s]);n.push(e(...o))}return n}function G(t,e){const n=t.indexOf(e);n>=0&&t.splice(n,1)}function Z(t,e,n){return n.indexOf(t)===e}var J={name:"DebugView",computed:{snappingPoints(){return this.constrainedElements.points.filter(t=>t).filter(Z).map(t=>({id:"tmp"+t.id,x:t.x,y:t.y}))},snappingSegments(){return this.constrainedElements.segments.filter(t=>t).filter(Z).map((t,e)=>{let n="tmp",s=new x,i=new x;return t instanceof $?(n+=t.id,s=t.bounds[0],i=t.bounds[1]):t instanceof W&&(n+="Seg"+e,s=t.A,i=t.B),{id:n,A:s,B:i}})},stepSegments(){if(this.currentShapePoints.length>0){const t=this.currentShapePoints.slice(-2).reverse();let e;if(this.minAngle>0&&t.length>1&&(e=Math.atan2(t[1].y-t[0].y,t[1].x-t[0].x)),this.angleStep>0)return F(t,e,{drawingSize:this.drawingSize,minStroke:this.minStroke,maxStroke:this.maxStroke,minAngle:this.minAngle,angleStep:this.angleStep}).map((t,e)=>({id:"Seg"+e,A:t.A,B:t.B}));{const n=new W(t[0],y(e-this.minAngle,this.maxStroke,t[0])),s=new W(t[0],y(e+this.minAngle,this.maxStroke,t[0]));return[n,s]}}return[]},...Object(o["c"])(["currentShapePoints"]),...Object(o["c"])("parameters",["drawingSize","minStroke","maxStroke","minAngle","angleStep"]),...Object(o["b"])(["constrainedElements"])}},Q=J,tt=Object(I["a"])(Q,D,T,!1,null,null,null),et=tt.exports,nt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{"opened-state":"tutorial"}},[s("div",[s("div",[s("img",{attrs:{id:"drawing",src:n("a305")}}),s("h1",[t._v("SPACES is a vector drawing software with a focus on keeping a constant distance between all shapes.")])]),s("ul",[s("li",[s("img",{attrs:{src:n("d77d")}}),t._v(" click to add points ")]),s("li",[s("img",{attrs:{src:n("e0d5")}}),t._v(" click on blue circle or "),s("i",[t._v("[enter]")]),t._v(" to close the shape ")]),s("li",[s("img",{attrs:{src:n("15ce")}}),t._v(" hold "),s("i",[t._v("[ctrl]")]),t._v(" to force angle steps ")]),s("li",[s("img",{attrs:{src:n("05cc")}}),s("i",[t._v("[ctrl]")]),t._v(" + scroll to zoom in and out ")]),s("li",[s("img",{attrs:{src:n("dd50")}}),s("i",[t._v("[space]")]),t._v(" + mouse drag to move the drawing ")])]),t.hasTactileScreen?[s("h2",[t._v("Please note that you'll need a MOUSE !")]),s("span",[t._v("This is a precision and productivity tool, hence it's not optimized for tactile use or phone screen size...")])]:t._e(),s("div",{attrs:{id:"lastLine"}},[s("a",{staticClass:"buttonLink",on:{click:function(e){return t.close()}}},[t._v(" Start ")])])],2)])},st=[],it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Transition",{attrs:{name:"fade"}},[t.opened?n("div",{attrs:{id:"overlay"},on:{click:function(e){return t.close()}}},[n("div",{class:t.panelClass,on:{click:function(t){t.stopPropagation()}}},[t._t("default"),n("img",{attrs:{id:"close",src:t.closeIcon},on:{click:function(e){return t.close()}}})],2)]):t._e()])},rt=[],ot=n("0880"),at=n.n(ot),lt={name:"Modal",props:{openedState:{type:String,default:""},small:Boolean},computed:{opened(){return this.$store.state.interactionState===this.openedState},closeIcon(){return at.a},panelClass(){const t=["contentPanel"];return this.small&&t.push("smallPanel"),t}},methods:{open(){this.$store.commit("setInteractionState",this.openedState)},close(){this.$store.commit("setInteractionState",a)},validate(){const t={handled:!1};this.$emit("validateModal",t),t.handled||this.close()},toggleKeysListening(t){if(this.listening!==t){this.listening=t;const e=t?document.addEventListener:document.removeEventListener;e("keyup",this.keyUp)}},keyUp(t){const e=t.key.toLowerCase();"enter"===e?this.validate():"escape"===e&&this.close()}},watch:{opened(){this.toggleKeysListening(this.opened)}},mounted(){this.opened&&this.toggleKeysListening(!0)},beforeDestroy(){this.toggleKeysListening(!1)}},ct=lt,ht=(n("d56b"),Object(I["a"])(ct,it,rt,!1,null,"306f4163",null)),ut=ht.exports,dt={name:"Tutorial",components:{Modal:ut},computed:{hasTactileScreen(){return navigator.maxTouchPoints>0}},methods:{close(){this.$store.commit("setInteractionState",a)}}},pt=dt,mt=(n("4617"),Object(I["a"])(pt,nt,st,!1,null,"2220405a",null)),gt=mt.exports,ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"menu"}},[n("h1",[t._v("SPACES")]),n("ul",t._l(t.items,(function(e){return n("MenuItem",t._b({key:e.label,attrs:{opened:e===t.openedItem},on:{toggleOpening:function(n){return t.toggleOpening(e)}}},"MenuItem",e,!1))})),1),n("div",{attrs:{id:"menuBottom"}},[n("MenuItem",t._b({attrs:{opened:t.parametersItem===t.openedItem},on:{toggleOpening:function(e){return t.toggleOpening(t.parametersItem)}}},"MenuItem",t.parametersItem,!1),[n("ParametersContent",{staticClass:"parameters"})],1)],1)])},vt=[],wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("a",{class:t.linkClass,on:{click:function(e){return t.action()},mousedown:function(e){return t.onMouseDown(e)},mouseup:function(e){return t.onMouseUpOrLeave(e)},mouseleave:function(e){return t.onMouseUpOrLeave(e)}}},[n(t.icon,{tag:"Component",staticClass:"icon"}),n("span",[t._v(t._s(t.label))]),t.shortcut?n("i",{staticClass:"shortcut"},[t._v(" "+t._s(t.shortcut)+" ")]):t._e(),t.hasChildren?n("Arrow",{staticClass:"arrow",attrs:{rotate:t.opened!==t.invertArrow}}):t._e()],1),n("CollapseTransition",[t.opened?n("div",{staticClass:"children"},[t._t("default",[n("ul",{staticClass:"subMenu"},t._l(t.children,(function(e){return n("MenuItem",t._b({key:e.label},"MenuItem",e,!1))})),1)])],2):t._e()]),n("Transition",{attrs:{name:"slide"}},[t.showTip?n("span",{attrs:{id:"tip"}},[t._v(" Hold ! ")]):t._e()])],1)},xt=[],yt=n("7c76"),St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{class:t.rotationClass,attrs:{"icon-name":"arrow",width:"10",height:"10"}},[n("path",{attrs:{d:"M 2 3 h 6 l-3 4z",stroke:"#000",fill:"#000"}})])},bt=[],kt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:t.width,height:t.height}},[n("title",{attrs:{id:t.iconName,lang:"en"}},[t._v(" "+t._s(t.iconName)+" icon ")]),t._t("default")],2)},Pt=[],Mt={props:{iconName:{type:String,default:"icon"},width:{type:[Number,String],default:24},height:{type:[Number,String],default:24}}},_t=Mt,At=(n("9c85"),Object(I["a"])(_t,kt,Pt,!1,null,null,null)),Ct=At.exports,Et={components:{IconBase:Ct},props:{rotate:Boolean},computed:{rotationClass(){return this.rotate?"rotate":""}}},Bt=Et,$t=(n("5f4b"),Object(I["a"])(Bt,St,bt,!1,null,"7d69c211",null)),Lt=$t.exports;const Ot=function(){};var It={name:"MenuItem",components:{CollapseTransition:yt["a"],Arrow:Lt},props:{label:{type:String,default:()=>""},icon:{type:Object,default:()=>{}},shortcut:{type:String,default:()=>""},isEnabled:{type:Function,default:()=>Ot},onClick:{type:Function,default:()=>Ot},onPress:{type:Function,default:()=>Ot},onRelease:{type:Function,default:()=>Ot},children:{type:Array,default:()=>[]},opened:Boolean,invertArrow:Boolean},data(){return{pressedTime:void 0,showTip:!1,tipTimeout:void 0}},computed:{linkClass(){return this.isEnabled()?"":"disabledLink"},hasChildren(){return this.children&&this.children.length>0||this.$slots.default}},methods:{action(){this.hasChildren?this.$emit("toggleOpening"):this.onClick&&this.onClick()},onMouseDown(t){this.onPress&&"default"!==this.onPress.name&&(this.onPress(),this.pressedTime=t.timeStamp,this.showTip=!1,this.tipTimeout&&clearTimeout(this.tipTimeout))},onMouseUpOrLeave(t){this.pressedTime&&(this.onRelease(),t.timeStamp-this.pressedTime<500&&this.launchTip(),this.pressedTime=void 0)},launchTip(){this.showTip=!0,this.tipTimeout=setTimeout(()=>{this.showTip=!1},2e3)}}},zt=It,jt=(n("da04"),Object(I["a"])(zt,wt,xt,!1,null,"6e49dd3a",null)),Dt=jt.exports,Tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("span",[t._v("min stroke size : ")]),n("b",[t._v(t._s(t.localMinStroke))]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.localMinStroke,expression:"localMinStroke"}],attrs:{type:"range",min:"0",max:"100"},domProps:{value:t.localMinStroke},on:{change:function(e){t.setMinStroke(parseInt(e.target.value,10))},__r:function(e){t.localMinStroke=e.target.value}}}),n("span",[t._v("max stroke size : ")]),n("b",[t._v(t._s(t.localMaxStroke))]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.localMaxStroke,expression:"localMaxStroke"}],attrs:{type:"range",min:"20",max:"1000"},domProps:{value:t.localMaxStroke},on:{change:function(e){t.setMaxStroke(parseInt(e.target.value,10))},__r:function(e){t.localMaxStroke=e.target.value}}}),n("span",[t._v("min Angle : ")]),n("b",[t._v(t._s(t.localMinAngle)+"°")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.localMinAngle,expression:"localMinAngle"}],attrs:{type:"range",min:"0",max:"90"},domProps:{value:t.localMinAngle},on:{change:function(e){t.setMinAngle(t.toRad(e.target.value))},__r:function(e){t.localMinAngle=e.target.value}}}),n("span",[t._v("angle steps")]),n("div",{staticClass:"optionLine"},t._l(t.angleValues,(function(e){return n("button",{key:"angleStep"+e,class:t.getStepClass(e),on:{click:function(n){return t.setStep(e)}}},[t._v(" "+t._s(0===e?"free":e+"°")+" ")])})),0)])},Wt=[],Ht={name:"ParametersContent",data(){return{localMinStroke:this.$store.state.parameters.minStroke,localMaxStroke:this.$store.state.parameters.maxStroke,localMinAngle:this.toDeg(this.$store.state.parameters.minAngle),localAngleStep:this.toDeg(this.$store.state.parameters.selectedAngleStep),angleValues:[5,10,15]}},methods:{getStepClass(t){const e=["option"];return this.toDeg(this.$store.state.parameters.selectedAngleStep)===t&&e.push("selectedOption"),e},toDeg(t){return Math.round(t/Math.PI*180)},toRad(t){return t/180*Math.PI},setMinStroke(t){this.localMaxStroke<t&&(this.localMaxStroke=t),this.$store.commit("parameters/setMinStroke",t)},setMaxStroke(t){this.localMinStroke>t&&(this.localMinStroke=t),this.$store.commit("parameters/setMaxStroke",t)},setMinAngle(t){this.$store.commit("parameters/setMinAngle",t)},setStep(t){this.$store.commit("parameters/setSelectedAngleStep",this.toRad(t))}}},Vt=Ht,Ut=(n("c06b"),Object(I["a"])(Vt,Tt,Wt,!1,null,"7ca351c8",null)),Ft=Ut.exports,Rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"new"}},[n("path",{staticClass:"blueStroke",attrs:{d:"m 10,4 h 8 V 20 H 6 V 8 Z"}}),n("path",{staticClass:"blueFill blueStroke",attrs:{d:"m 6,8 h 4 V 4"}})])},Nt=[],qt={components:{IconBase:Ct}},Yt=qt,Kt=Object(I["a"])(Yt,Rt,Nt,!1,null,null,null),Xt=Kt.exports,Gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"undo"}},[n("path",{staticClass:"blueFill blueStroke",attrs:{d:"m 12,4 v 6 l -4,-3 z"}}),n("path",{staticClass:"blueStroke",attrs:{d:"m 12,7 a 6,6 0 0 1 5.5,3.7 6,6 0 0 1 -1.3,6.5 6,6 0 0 1 -6.5,1.3 6,6 0 0 1 -3.7,-5.5"}})])},Zt=[],Jt={components:{IconBase:Ct}},Qt=Jt,te=Object(I["a"])(Qt,Gt,Zt,!1,null,null,null),ee=te.exports,ne=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"redo"}},[n("path",{staticClass:"blueFill blueStroke",attrs:{d:"m 12,4 v 6 l 4,-3 z"}}),n("path",{staticClass:"blueStroke",attrs:{d:"m 12,7 a 6,6 1 0 0 -5.5,3.7 6,6 1 0 0 1.3,6.5 6,6 1 0 0 6.5,1.3 6,6 1 0 0 3.7,-5.5"}})])},se=[],ie={components:{IconBase:Ct}},re=ie,oe=Object(I["a"])(re,ne,se,!1,null,null,null),ae=oe.exports,le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"preview"}},[n("path",{staticClass:"blueStroke",attrs:{d:"m 4,12 c 0,0 1.6,-6 8,-6 C 18.4,6 20,12 20,12"}}),n("circle",{staticClass:"blueStroke",attrs:{cx:"12",cy:"12",r:"3"}})])},ce=[],he={components:{IconBase:Ct}},ue=he,de=Object(I["a"])(ue,le,ce,!1,null,null,null),pe=de.exports,me=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"export"}},[n("path",{staticClass:"blueFill blueStroke",attrs:{d:"M 9,12 H 15 l -3,4 z"}}),n("path",{staticClass:"blueStroke",attrs:{d:"M 18,19 H 6"}}),n("path",{staticClass:"blueStroke",attrs:{d:"M 12,4 V 11"}})])},ge=[],fe={components:{IconBase:Ct}},ve=fe,we=Object(I["a"])(ve,me,ge,!1,null,null,null),xe=we.exports,ye=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"guides"}},[n("path",{staticClass:"grayStroke",attrs:{d:"M5,4 19,20",opacity:"0.5"}}),n("circle",{staticClass:"whiteFill blueStroke",attrs:{r:"3",cy:"14",cx:"14"}})])},Se=[],be={components:{IconBase:Ct}},ke=be,Pe=Object(I["a"])(ke,ye,Se,!1,null,null,null),Me=Pe.exports,_e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"current"}},[n("path",{staticClass:"grayStroke",attrs:{d:"M7,20 16,10"}}),n("circle",{staticClass:"whiteFill blueStroke",attrs:{cx:"16",cy:"10",r:"3"}})])},Ae=[],Ce={components:{IconBase:Ct}},Ee=Ce,Be=Object(I["a"])(Ee,_e,Ae,!1,null,null,null),$e=Be.exports,Le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"next"}},[n("path",{staticClass:"grayStroke",attrs:{d:"M7,20 16,10"}}),n("circle",{staticClass:"whiteFill blueStroke",attrs:{cx:"16",cy:"10",r:"3"}}),n("g",{staticClass:"grayFill"},[n("circle",{attrs:{r:"1",cx:"4",cy:"6"}}),n("circle",{attrs:{r:"1",cx:"7",cy:"7"}}),n("circle",{attrs:{r:"1",cx:"10",cy:"8"}})])])},Oe=[],Ie={components:{IconBase:Ct}},ze=Ie,je=Object(I["a"])(ze,Le,Oe,!1,null,null,null),De=je.exports,Te=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("IconBase",{attrs:{"icon-name":"parameters"}},[n("circle",{staticClass:"grayStroke",attrs:{cx:"12",cy:"12",r:"4.5","stroke-width":"3"}}),n("path",{staticClass:"grayFill grayStroke",attrs:{id:"A",d:"M 11,5 10.447266,7.2539061 A 5,5 0 0 1 12,7 5,5 0 0 1 13.558594,7.251953 L 13,5 Z"}}),n("use",{attrs:{"xlink:href":"#A",transform:"rotate(60 12 12)"}}),n("use",{attrs:{"xlink:href":"#A",transform:"rotate(120 12 12)"}}),n("use",{attrs:{"xlink:href":"#A",transform:"rotate(180 12 12)"}}),n("use",{attrs:{"xlink:href":"#A",transform:"rotate(240 12 12)"}}),n("use",{attrs:{"xlink:href":"#A",transform:"rotate(300 12 12)"}})])},We=[],He={components:{IconBase:Ct}},Ve=He,Ue=Object(I["a"])(Ve,Te,We,!1,null,null,null),Fe=Ue.exports,Re={name:"Menu",components:{MenuItem:Dt,ParametersContent:Ft},data(){return{openedItem:void 0,items:[{label:"New",icon:Xt,onClick:this.new},{label:"Undo",icon:ee,shortcut:"ctrl+Z",isEnabled:this.canUndo,onClick:this.undo},{label:"Redo",icon:ae,shortcut:"ctrl+Y",isEnabled:this.canRedo,onClick:this.redo},{label:"Preview result",icon:pe,shortcut:"R",isEnabled:this.hasShape,onPress:this.preview,onRelease:this.stopPreview},{label:"Export",icon:xe,isEnabled:this.hasShape,onClick:this.export},{label:"Guides",icon:Me,children:[{label:"Add horizontal",shortcut:"H",isEnabled:()=>!1},{label:"Add vertical",shortcut:"V",isEnabled:()=>!1},{label:"Clear all",shortcut:"G",isEnabled:()=>!1}]},{label:"Current stroke",icon:$e,children:[{label:"Parallel to line",shortcut:"L",isEnabled:()=>!1},{label:"Points toward",shortcut:"P",isEnabled:()=>!1},{label:"Copy length",shortcut:"S",isEnabled:()=>!1}]},{label:"Next stroke",icon:De,children:[{label:"Parallel to line…",shortcut:"N",isEnabled:()=>!1}]}],parametersItem:{label:"Parameters",icon:Fe,invertArrow:!0}}},methods:{toggleOpening(t){this.openedItem===t?this.openedItem=void 0:this.openedItem=t},canUndo(){return this.$store.getters.canUndo},canRedo(){return this.$store.getters.canRedo},hasShape(){return this.$store.state.shapes.length>0},new(){this.$store.commit("setInteractionState",u)},undo(){this.$store.commit("undo")},redo(){this.$store.commit("redo")},preview(){this.$store.commit("setInteractionState",h)},stopPreview(){this.$store.commit("setInteractionState",a)},export(){this.$store.commit("setInteractionState",c)}}},Ne=Re,qe=(n("c577"),Object(I["a"])(Ne,ft,vt,!1,null,"0daf0a82",null)),Ye=qe.exports,Ke=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Modal",{attrs:{"opened-state":"export",small:""}},[n("Exporter")],1)},Xe=[],Ge=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",[t._v("Export to svg")]),n("div",{attrs:{id:"centerBlock"}},[n("Transition",{attrs:{name:"fade",mode:"out-in"}},[t.loading?n("img",{key:"loadingWheel",attrs:{src:t.loadingWheel}}):n("a",{key:"loadedButton",staticClass:"buttonLink",attrs:{download:"export.svg",href:t.downloadUrl}},[t._v(" Download ")])])],1)])},Ze=[];function Je(t,e){let n="";return t.forEach((t,e)=>{n+=0===e?"M":"L",n+=t.x+" "+t.y+" "}),e&&(n+="Z"),n}function Qe(t,e){let n=`<svg xmlns="http://www.w3.org/2000/svg" width="${e.x}" height="${e.y}">\n`;return t.forEach(t=>{let e='<path stroke-width="0" fill="black"';e+=` d="${Je(t.points,!0)}"`,e+=" />",n+=e+"\n"}),n+="</svg>",n}var tn=n("7cc5"),en=n.n(tn),nn={name:"Exporter",data(){return{loading:!0,downloadUrl:"#"}},computed:{loadingWheel(){return en.a}},mounted(){this.loading=!0;const t=Qe(this.$store.state.shapes,this.$store.state.parameters.drawingSize),e=new Blob([t],{type:"text/svg"});this.downloadUrl=window.URL.createObjectURL(e),setTimeout(()=>{this.loading=!1},1e3)},beforeDestroy(){window.URL.revokeObjectURL(this.downloadUrl)}},sn=nn,rn=(n("51ff"),Object(I["a"])(sn,Ge,Ze,!1,null,"29c1fdee",null)),on=rn.exports,an={name:"ExportModal",components:{Modal:ut,Exporter:on}},ln=an,cn=Object(I["a"])(ln,Ke,Xe,!1,null,null,null),hn=cn.exports,un=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Modal",{attrs:{"opened-state":"new",small:""},on:{validateModal:function(e){return t.modalValidation(e)}}},[n("h1",[t._v("New drawing")]),n("form",{ref:"form",attrs:{id:"newDrawingForm"}}),n("div",{staticClass:"inputs"},[n("label",[n("span",[t._v("Width")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.width,expression:"width",modifiers:{number:!0}}],attrs:{form:"newDrawingForm",type:"number",min:"200",max:"9000",required:""},domProps:{value:t.width},on:{input:[function(e){e.target.composing||(t.width=t._n(e.target.value))},function(e){return t.updateValidity()}],keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.stopPropagation()},blur:function(e){return t.$forceUpdate()}}})]),n("label",[n("span",[t._v("Height")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.height,expression:"height",modifiers:{number:!0}}],attrs:{form:"newDrawingForm",type:"number",min:"200",max:"9000",required:""},domProps:{value:t.height},on:{input:[function(e){e.target.composing||(t.height=t._n(e.target.value))},function(e){return t.updateValidity()}],keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.stopPropagation()},blur:function(e){return t.$forceUpdate()}}})]),n("label",[n("span",[t._v("Shapes gap")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.gap,expression:"gap",modifiers:{number:!0}}],attrs:{form:"newDrawingForm",type:"number",min:"2",max:"900",required:""},domProps:{value:t.gap},on:{input:[function(e){e.target.composing||(t.gap=t._n(e.target.value))},function(e){return t.updateValidity()}],keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.stopPropagation()},blur:function(e){return t.$forceUpdate()}}})])]),n("div",{staticClass:"lastLine"},[n("button",{staticClass:"buttonLink secondaryButton",on:{click:function(e){return t.cancel()},keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.stopPropagation()}}},[t._v(" Cancel ")]),n("button",{class:t.createButtonClass,attrs:{type:"submit",form:"newDrawingForm"},on:{click:function(e){return e.preventDefault(),t.create()},keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.stopPropagation()}}},[t._v(" Create ")])])])},dn=[],pn={name:"New",components:{Modal:ut},data(){return{width:1e3,height:600,gap:10,isValid:!0}},computed:{createButtonClass(){const t=["buttonLink"];return this.isValid||t.push("disabledButton"),t}},methods:{updateValidity(){this.isValid=this.$refs.form.checkValidity()},cancel(){this.$store.commit("setInteractionState",a)},create(){this.isValid&&this.$store.dispatch("createNew",{width:this.width,height:this.height,gap:this.gap})},modalValidation(t){t.handled=!0,this.create()}}},mn=pn,gn=(n("c495"),Object(I["a"])(mn,un,dn,!1,null,"f659fed0",null)),fn=gn.exports,vn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:t.cursorStyle,attrs:{id:"container"},on:{wheel:function(e){return e.preventDefault(),t.onWheel(e)}}},[n("svg",{ref:"viewer",attrs:{id:"viewer",xmlns:"http://www.w3.org/2000/svg"}},[n("g",{ref:"viewerContent",attrs:{transform:t.transformMatrix}},[t._t("default")],2)]),n("div",{attrs:{id:"scrollContainer"}},[n("div",{attrs:{id:"hScrollContainer"}},[n("div",{ref:"hScrollBar",staticClass:"scrollBar",style:t.hBarStyle,on:{mousedown:function(e){return e.stopPropagation(),t.horizontalHandler.hang(e)}}})]),n("div",{attrs:{id:"vScrollContainer"}},[n("div",{ref:"vScrollBar",staticClass:"scrollBar",style:t.vBarStyle,on:{mousedown:function(e){return e.stopPropagation(),t.verticalHandler.hang(e)}}})])])])},wn=[],xn=new s["a"];class yn{constructor(t,e,n,s){this.getDeltaRatio=t||function(){return{x:1,y:1}},this.getPan=e,this.setPan=n,this.registerMouseMove=s,this.initPan={x:0,y:0},this.initMouse={x:0,y:0},this.panning=!1}handleEvent(t){switch(t.type){case"mousedown":this.hang(t);break;case"mousemove":this.move(t);break;case"mouseup":this.drop(t);break;default:break}}hang(t){t.stopPropagation(),t.preventDefault(),this.initPan=this.getPan(),this.initMouse={x:t.pageX,y:t.pageY},this.panning=!0,window.addEventListener("mouseup",this,!0),this.registerMouseMove&&window.addEventListener("mousemove",this,!0)}move(t){if(t.stopPropagation(),t.preventDefault(),this.panning){const e=this.getDeltaRatio(),n=e.x*(t.pageX-this.initMouse.x),s=e.y*(t.pageY-this.initMouse.y);this.setPan(this.initPan.x+n,this.initPan.y+s)}}drop(t){t&&(t.stopPropagation(),t.preventDefault()),this.panning=!1,window.removeEventListener("mouseup",this,!0),this.registerMouseMove&&window.removeEventListener("mousemove",this,!0)}}var Sn={name:"SvgViewport",data(){return{minZoom:.2,maxZoom:20,barsWidth:14,x:20,y:20,zoom:.7,offset:{x:0,y:0},availableWidth:1e3,availableHeight:1e3,horizontalHandler:new yn(this.hBarPanRatio,this.getPan,this.setPan,!0),verticalHandler:new yn(this.vBarPanRatio,this.getPan,this.setPan,!0),mouseHandler:new yn(void 0,this.getPan,this.setPan,!1),mousePanMode:!1}},mounted(){window.addEventListener("resize",this,!1),this.onResize(),this.centerDrawing(),xn.$on("newDrawing",this.centerDrawing)},beforeDestroy(){window.removeEventListener("resize",this,!1),xn.$off("newDrawing",this.centerDrawing)},computed:{drawingWidth(){return this.$store.state.parameters.drawingSize.x},drawingHeight(){return this.$store.state.parameters.drawingSize.y},transformMatrix(){return`matrix(${this.zoom}, 0, 0, ${this.zoom}, ${this.x}, ${this.y})`},panBounds(){const t=20;return{minX:t-this.drawingWidth*this.zoom,minY:t-this.drawingHeight*this.zoom,maxX:this.availableWidth-t,maxY:this.availableHeight-t}},hBarSize(){return(this.availableWidth-this.barsWidth)/(this.zoom/this.minZoom)},hBarMaxSize(){return this.availableWidth-this.hBarSize-this.barsWidth},hBarStyle(){const t=(this.x-this.panBounds.minX)/(this.panBounds.maxX-this.panBounds.minX),e=(1-t)*this.hBarMaxSize;return{height:this.barsWidth+"px",width:this.hBarSize+"px",left:e+"px"}},vBarSize(){return(this.availableHeight-this.barsWidth)/(this.zoom/this.minZoom)},vBarMaxSize(){return this.availableHeight-this.vBarSize-this.barsWidth},vBarStyle(){const t=(this.y-this.panBounds.minY)/(this.panBounds.maxY-this.panBounds.minY),e=(1-t)*this.vBarMaxSize;return{width:this.barsWidth+"px",height:this.vBarSize+"px",top:e+"px"}},cursorStyle(){return{cursor:this.mousePanMode?this.mouseHandler.panning?"grabbing":"grab":"auto"}}},methods:{initMousePan(){this.mousePanMode||(this.mousePanMode=!0,window.addEventListener("mousedown",this.mouseHandler,!0),window.addEventListener("mousemove",this.mouseHandler,!0))},stopMousePan(){this.mousePanMode&&(this.mousePanMode=!1,this.mouseHandler.drop(),window.removeEventListener("mousedown",this.mouseHandler,!0),window.removeEventListener("mousemove",this.mouseHandler,!0))},getPan(){return{x:this.x,y:this.y}},setPan(t,e){const n=this.panBounds;this.x=Math.max(n.minX,Math.min(n.maxX,t)),this.y=Math.max(n.minY,Math.min(n.maxY,e))},hBarPanRatio(){const t=(this.panBounds.maxX-this.panBounds.minX)/this.hBarMaxSize;return{x:-t,y:0}},vBarPanRatio(){const t=(this.panBounds.maxY-this.panBounds.minY)/this.vBarMaxSize;return{x:0,y:-t}},pointToSvg(t){const e=this.$refs.viewer.createSVGPoint();e.x=t.x,e.y=t.y;const n=e.matrixTransform(this.$refs.viewerContent.getScreenCTM().inverse());return{x:n.x,y:n.y}},handleEvent(t){switch(t.type){case"resize":this.onResize(t);break;default:break}},onResize(){const t=this.$refs.viewer.getBoundingClientRect();this.offset={x:t.x,y:t.y},this.availableWidth=t.width,this.availableHeight=t.height},onWheel(t){if(t.ctrlKey){let e=this.zoom*(1-.1*Math.sign(t.deltaY));if(e=Math.max(this.minZoom,Math.min(this.maxZoom,e)),e!==this.zoom){const n=this.$refs.viewerContent.getScreenCTM(),s=this.$refs.viewer.createSVGPoint();s.x=t.pageX,s.y=t.pageY;const i=s.matrixTransform(n.inverse()),r=this.$refs.viewer.createSVGMatrix().translate(i.x,i.y).scale(e/this.zoom).translate(-i.x,-i.y),o=n.multiply(r);this.zoom=o.a,this.setPan(o.e-this.offset.x,o.f-this.offset.y)}}else this.setPan(this.x+-10*Math.sign(t.deltaX),this.y+-10*Math.sign(t.deltaY))},centerDrawing(){const t=30,e=2*t,n=this.availableWidth/this.availableHeight,s=(this.drawingWidth+e+this.barsWidth)/(this.drawingHeight+e+this.barsWidth);s>n?(this.zoom=(this.availableWidth-e-this.barsWidth)/this.drawingWidth,this.x=t,this.y=(this.availableHeight-this.barsWidth-this.zoom*this.drawingHeight)/2):(this.zoom=(this.availableHeight-e-this.barsWidth)/this.drawingHeight,this.y=t,this.x=(this.availableWidth-this.barsWidth-this.zoom*this.drawingWidth)/2)}}},bn=Sn,kn=(n("32e3"),Object(I["a"])(bn,vn,wn,!1,null,"7f2576c4",null)),Pn=kn.exports,Mn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("circle",{class:t.circleClass,attrs:{cx:t.point.x,cy:t.point.y,r:t.size}})},_n=[];const An={cursor:1,startPoint:2,guide:3};function Cn(t){switch(t){case 1:return"cursor";case 2:return"startPoint";case 3:return"guide";default:return""}}Object.freeze(An);var En={name:"DrawingPoint",props:{point:{type:Object,default:new x},type:{type:Number,default:An.guide},hovered:Boolean},computed:{size(){switch(this.type){case 1:return 5;case 2:return this.hovered?7:5;case 3:return 3;default:return 0}},circleClass(){return Cn(this.type)+(this.hovered?"Hovered":"")}}},Bn=En,$n=(n("8c7d"),Object(I["a"])(Bn,Mn,_n,!1,null,"2c85e2a3",null)),Ln=$n.exports,On=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",[t._l(t.lines,(function(e){return n("DrawingLine",{key:e.id,attrs:{p1:e.bounds[0],p2:e.bounds[1],hovered:t.amIHovered(e)}})})),t._l(t.intersections,(function(e){return n("DrawingPoint",{key:e.id,attrs:{point:e,type:3,hovered:t.amIHovered(e)}})}))],2)},In=[],zn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("line",{class:t.lineClass,attrs:{x1:t.p1.x,y1:t.p1.y,x2:t.p2.x,y2:t.p2.y}})},jn=[],Dn={name:"DrawingLine",props:{p1:{type:Object,default:new x},p2:{type:Object,default:new x},hovered:Boolean},computed:{lineClass(){return this.hovered?"hoveredLine":""}}},Tn=Dn,Wn=(n("21ab"),Object(I["a"])(Tn,zn,jn,!1,null,"cecd459a",null)),Hn=Wn.exports,Vn={name:"Guides",components:{DrawingPoint:Ln,DrawingLine:Hn},computed:{...Object(o["c"])(["hoveredElement"]),...Object(o["b"])(["lines","intersections"])},methods:{amIHovered(t){return this.hoveredElement===t||this.hoveredElement instanceof b&&t instanceof $&&this.hoveredElement.crossingLines.includes(t)}}},Un=Vn,Fn=Object(I["a"])(Un,On,In,!1,null,null,null),Rn=Fn.exports,Nn={name:"App",components:{DebugInfo:j,DebugView:et,Tutorial:gt,Menu:Ye,ExportModal:hn,New:fn,SvgViewport:Pn,DrawingPoint:Ln,Guides:Rn},data(){return{debugMode:!1,snapThreshold:20,mousePosition:new x,currentPoint:new x,downBeforeUp:!1}},computed:{showStartPoint(){return this.currentShapePoints.length>2},startPoint(){return this.currentShapePoints[0]},currentPath(){return Je(this.currentShapePoints.concat(this.currentPoint),!1)},shouldListenToKeyEvents(){return this.interactionState===a||this.interactionState===h},...Object(o["c"])(["shapes","currentShapePoints","hoveredElement","interactionState"]),...Object(o["c"])("parameters",["drawingSize"]),...Object(o["b"])(["lines","intersections","constrainedElements","drawingState"])},watch:{shouldListenToKeyEvents(){const t=this.shouldListenToKeyEvents?document.addEventListener:document.removeEventListener;t("keydown",this.keyDown),t("keyup",this.keyUp)}},mounted(){window.addEventListener("blur",this.windowLostFocus)},beforeDestroy(){window.removeEventListener("blur",this.windowLostFocus)},methods:{getPosition(t){const e=this.$refs.svgViewport.pointToSvg({x:t.pageX,y:t.pageY});return new x(e.x,e.y)},getPath(t){return Je(t,!0)},closeCurrentShape(){this.$store.commit("validateCurrentShape")},cancelCurrentShape(){this.currentShapePoints.length>0&&this.$store.commit("cancelShape")},getSnappedPosition(t){let e,n,s=N(t,this.currentShapePoints,{minStroke:this.$store.state.parameters.minStroke,maxStroke:this.$store.state.parameters.maxStroke,minAngle:this.$store.state.parameters.minAngle,angleStep:this.$store.state.parameters.angleStep}),i=this.snapThreshold*this.snapThreshold;const{points:r,segments:o}=this.constrainedElements;if(r.forEach(t=>{const n=t.getSquaredDistanceTo(s);n<i&&(i=n,e=t)}),void 0===e){let t;o.forEach(n=>{const r=n.getProjection(s),o=r.getSquaredDistanceTo(s);o<i&&(i=o,e=r,t=n)}),void 0!==e&&(s=e,n=t instanceof $?t:t.associatedLine)}else s=e,n=e;return n!==this.hoveredElement&&this.$store.commit("setHoveredElement",n),s},updateCurrentPoint(){this.currentPoint=this.getSnappedPosition(this.mousePosition)},mouseMove(t){this.mousePosition=this.getPosition(t),this.mousePosition.x>=0&&this.mousePosition.x<=this.drawingSize.x&&this.mousePosition.y>=0&&this.mousePosition.y<=this.drawingSize.y&&this.updateCurrentPoint()},mouseDown(){this.downBeforeUp=!0},mouseUp(t){if(this.downBeforeUp&&(this.downBeforeUp=!1,this.drawingState)){const e=this.getSnappedPosition(this.getPosition(t));if(this.showStartPoint&&e===this.startPoint)this.closeCurrentShape();else{let t=e;t instanceof b||(t=new b(e.x,e.y),this.hoveredElement instanceof $&&t.crossingLines.push(this.hoveredElement)),this.$store.commit("addPoint",t)}}},keyDown(t){const e=t.key.toLowerCase();"control"===e?this.toggleAngleSteps(!0):"r"!==e||t.repeat?" "!==e||t.repeat||this.$refs.svgViewport.initMousePan():this.togglePreviewMode(!0)},keyUp(t){const e=t.key.toLowerCase();"control"===e?this.toggleAngleSteps(!1):"z"===e&&t.ctrlKey?t.shiftKey?this.$store.commit("redo"):this.$store.commit("undo"):"y"===e&&t.ctrlKey?this.$store.commit("redo"):"d"===e?this.debugMode=!this.debugMode:"r"===e?this.togglePreviewMode(!1):"enter"===e?this.closeCurrentShape():"escape"===e?this.cancelCurrentShape():" "===e&&this.$refs.svgViewport.stopMousePan()},windowLostFocus(){this.toggleAngleSteps(!1),this.togglePreviewMode(!1)},toggleAngleSteps(t){this.$store.state.parameters.toggleAngleSteps!==t&&(this.$store.commit("parameters/toggleAngleSteps",t),this.updateCurrentPoint())},togglePreviewMode(t){const e=this.$store.state.interactionState;t&&e===a?this.$store.commit("setInteractionState",h):t||e!==h||this.$store.commit("setInteractionState",a)}}},qn=Nn,Yn=(n("034f"),Object(I["a"])(qn,i,r,!1,null,null,null)),Kn=Yn.exports,Xn={namespaced:!0,state:{drawingSize:{x:1e3,y:600},shapesGap:10,snapThreshold:20,minStroke:0,maxStroke:1e3,minAngle:10*Math.PI/180,selectedAngleStep:10*Math.PI/180,angleStep:0},mutations:{setMinStroke(t,e){t.minStroke=e},setMaxStroke(t,e){t.maxStroke=e},setMinAngle(t,e){t.minAngle=e},setSelectedAngleStep(t,e){t.selectedAngleStep=e},toggleAngleSteps(t,e){const n=e?t.selectedAngleStep:0;t.angleStep!==n&&(t.angleStep=n)},setDrawingProperties(t,e){t.drawingSize.x=e.width,t.drawingSize.y=e.height,t.shapesGap=e.gap}}};let Gn=0;class Zn{constructor(t,e,n,s){this.points=[...t];let i=this.points;k(i)||(i=[...t].reverse());const r=new Map(X(i,(t,s)=>{let i=t.crossingLines.find(t=>t.includes(s));return void 0===i&&(i=s.crossingLines.find(e=>e.includes(t))),void 0===i?i=new $(t,s,e,n):(i.addPoint(t),i.addPoint(s)),[t,i]}));this.lines=Array.from(r.values()),this.spacedLines=[];const o=(t,i,o,a)=>{const l=r.get(t),c=r.get(i),h=r.get(o);let u,d,p,m,g;if(c.parallels.length>0&&(u=c.parallels[0],d=u.getKnownIntersectionWith(l),p=u.getKnownIntersectionWith(h),m=void 0===d?u.intersections.find(t=>t!==p):d,g=void 0===p?u.intersections.find(t=>t!==d&&t!==m):p),void 0===d||void 0===p){if(void 0===m||void 0===g){const t=P(i,o,s);m=m||t.A2,g=g||t.B2}if(void 0===d){const e=M(t,i,m,g);d=e instanceof x?b.createFrom(e):m}if(void 0===p){const t=M(m,g,o,a);p=t instanceof x?b.createFrom(t):g}}void 0===u?u=new $(d,p,e,n):(u.addPoint(d),u.addPoint(p)),l.addPoint(d),h.addPoint(p),$.linkParallelLines(c,u),this.spacedLines.push(u)};K(i,o,-1),K(this.spacedLines,(t,e)=>{t.getOrCreateIntersectionWith(e)}),this.lines.concat(this.spacedLines).forEach(t=>t.linkedShapes.push(this)),this.id="S"+Gn++}updateIntersections(t){const e=this.lines.concat(this.spacedLines);t.forEach(t=>{e.forEach(e=>{t.getOrCreateIntersectionWith(e)})})}removeAllLinks(){const t=this.lines.concat(this.spacedLines).filter(t=>1===t.linkedShapes.length);t.forEach(t=>{t.parallels.forEach(e=>{G(e.parallels,t)}),t.parallels=[],t.linkedShapes=[]}),[...t.map(t=>t.intersections).flat()].forEach(e=>{e.crossingLines.forEach(t=>{G(t.intersections,e)}),t.forEach(t=>{G(e.crossingLines,t)})})}}s["a"].use(o["a"]);const Jn={lines(t){return t.shapes.map(t=>t.lines.concat(t.spacedLines)).flat().filter(Z)},intersections(t,e){return e.lines.map(t=>t.intersections).flat().filter(Z).filter(e=>_(e,t.parameters.drawingSize.x,t.parameters.drawingSize.y))},constrainedElements(t,e){const n=[...e.intersections];return t.currentShapePoints.length>2&&n.push(t.currentShapePoints[0]),H(n,e.lines,t.currentShapePoints,{drawingSize:t.parameters.drawingSize,minStroke:t.parameters.minStroke,maxStroke:t.parameters.maxStroke,minAngle:t.parameters.minAngle,angleStep:t.parameters.angleStep})},canUndo(t){return t.shapes.length>0||t.currentShapePoints.length>0},canRedo(t){return t.redoStack.length>0},drawingState(t){return t.interactionState===a}},Qn=function(t){const e=new Zn(t.currentShapePoints,t.parameters.drawingSize.x,t.parameters.drawingSize.y,t.parameters.shapesGap);e.updateIntersections(Jn.lines(t)),t.currentShapePoints=[],t.shapes.push(e)},ts=!1;var es=new o["a"].Store({strict:ts,state:{interactionState:l,shapes:[],currentShapePoints:[],hoveredElement:void 0,redoStack:[]},modules:{parameters:Xn},mutations:{setInteractionState(t,e){t.interactionState=e},addPoint(t,e){t.currentShapePoints.push(e),t.redoStack=[]},validateCurrentShape(t){Qn(t),t.redoStack=[]},setHoveredElement(t,e){t.hoveredElement=e},undo(t){if(t.currentShapePoints.length>0)t.redoStack.push(t.currentShapePoints.pop());else if(t.shapes.length>0){const e=t.shapes.pop();t.currentShapePoints=e.points,e.removeAllLinks(),t.redoStack.push("closeShape")}},cancelShape(t){if(t.currentShapePoints.length>0){const e=[...t.currentShapePoints].reverse();t.redoStack.push(...e),t.currentShapePoints=[]}},redo(t){if(t.redoStack.length>0){const e=t.redoStack.pop();e instanceof x?t.currentShapePoints.push(e):"closeShape"===e&&Qn(t)}},reset(t){t.shapes=[],t.currentShapePoints=[],t.hoveredElement=void 0,t.redoStack=[]}},getters:Jn,actions:{createNew(t,e){t.commit("reset"),t.commit("parameters/setDrawingProperties",e),xn.$emit("newDrawing"),t.commit("setInteractionState",a)}}});s["a"].config.productionTip=!1,new s["a"]({store:es,render(t){return t(Kn)}}).$mount("#app")},"5eb8":function(t,e,n){},"5f4b":function(t,e,n){"use strict";var s=n("5160"),i=n.n(s);i.a},"7bab":function(t,e,n){},"7cc5":function(t,e,n){t.exports=n.p+"img/loadingWheel.6ff13ec8.svg"},"85ec":function(t,e,n){},"8c7d":function(t,e,n){"use strict";var s=n("3736"),i=n.n(s);i.a},"9c85":function(t,e,n){"use strict";var s=n("a7fa"),i=n.n(s);i.a},a305:function(t,e,n){t.exports=n.p+"img/drawing.545a5bdd.svg"},a7fa:function(t,e,n){},b199:function(t,e,n){"use strict";var s=n("18f6"),i=n.n(s);i.a},c06b:function(t,e,n){"use strict";var s=n("e2b2"),i=n.n(s);i.a},c233:function(t,e,n){},c495:function(t,e,n){"use strict";var s=n("3d99"),i=n.n(s);i.a},c577:function(t,e,n){"use strict";var s=n("cfde"),i=n.n(s);i.a},cfde:function(t,e,n){},d56b:function(t,e,n){"use strict";var s=n("0c1b"),i=n.n(s);i.a},d77d:function(t,e,n){t.exports=n.p+"img/add.ad882c1a.svg"},da04:function(t,e,n){"use strict";var s=n("5eb8"),i=n.n(s);i.a},dd50:function(t,e,n){t.exports=n.p+"img/move.85173331.svg"},e0d5:function(t,e,n){t.exports=n.p+"img/end.b1dd04da.svg"},e2b2:function(t,e,n){}});
//# sourceMappingURL=app.fa9dbd2d.js.map